riot.tag2("main",'<div if="{tool}" class="container"><div class="help-tip hide-phone"><p> The build tool can be changed using the hamburger menu on the left. For more information about this tool please visit <a href="{tool.url}">{tool.id}</a> website.<br><br> This is a progressive webapp, meaning that you can add it to your desktop and it can even run offline. You can boostrap your project even on the go without internet! </p></div><h1>{tool.id}: {tool.file}</h1><form onsubmit="{generate}"><div each="{f, i in tool.fields}" class="row"><virtual if="{i % 2 === 0}"><div class="col-6"><input name="{tool.fields[i].key}" type="text" placeholder="{tool.fields[i].label + (tool.fields[i].prefill ? \' e.g.: \' + tool.fields[i].prefill : \'\')}" required="{tool.fields[i].required}"></div><div class="col-6"><input if="{tool.fields[i+1]}" name="{tool.fields[i+1].key}" type="text" placeholder="{tool.fields[i+1].label + (tool.fields[i+1].prefill ? \' e.g.: \' + tool.fields[i+1].prefill : \'\')}" required="{tool.fields[i+1].required}"></div></virtual></div><div if="{tool.languages || presets}" class="row"><div class="col-6"><select id="language" disabled="{!tool.languages || tool.languages.length == 0}" onchange="{changeLanguage}"><option each="{tool.languages}" riot-value="{id}">{id}</option></select></div><div class="col-6"><select id="preset" disabled="{!presetGroups || presetGroups.length == 0}" onchange="{changePreset}"><option value="">Empty Project</option><optgroup each="{g, i in presetGroups}" label="{i}"><option each="{g}" riot-value="{id}">{id}</option></optgroup></select></div></div><div if="{preset.fields}" class="row"><h5>Extra variables for {preset.id}:</h5></div><div each="{f, i in preset.fields}" class="row"><virtual if="{i % 2 === 0}"><div class="col-6"><input name="{preset.fields[i].key}" type="text" placeholder="{preset.fields[i].label + (preset.fields[i].prefill ? \' e.g.: \' + preset.fields[i].prefill : \'\')}" required="{preset.fields[i].required}"></div><div class="col-6"><input if="{preset.fields[i+1]}" name="{preset.fields[i+1].key}" type="text" placeholder="{preset.fields[i+1].label + (preset.fields[i+1].prefill ? \' e.g.: \' + preset.fields[i+1].prefill : \'\')}" required="{preset.fields[i+1].required}"></div></virtual></div><div class="row"><div class="col-6"><h1>Dependencies</h1></div><div class="col-6"><div id="not-found-tip" class="help-tip hide-phone"><p>Use this box to search for dependencies to add to your application, if a dependency is not present, please <a href="https://github.com/pmlopes/vertx-starter/issues/new">open an issue</a> so we can add the missing metadata!</p></div><input type="text" class="pull-right" placeholder="Search dependency..." onkeyup="{search}"></div></div><div each="{c, i in dependencies}" class="row"><virtual if="{i % 2 == 0}"><div class="col-6"><div class="{dependency: dependencies[i].checked}"><input name="dependencies" type="checkbox" riot-value="{i}" checked="{dependencies[i].checked}" onclick="{toggleDependency}"><div><span if="{dependencies[i].stack}" class="pull-right"><img src="img/stack.svg" width="16px"></span><strong>{dependencies[i].artifactId}</strong><hr><p if="{dependencies[i].description}">{dependencies[i].description}</p></div><br></div></div><div class="col-6"><div if="{dependencies[i+1]}" class="{dependency: dependencies[i+1].checked}"><input name="dependencies" type="checkbox" riot-value="{i+1}" checked="{dependencies[i+1].checked}" onclick="{toggleDependency}"><div><span if="{dependencies[i+1].stack}" class="pull-right"><img src="img/stack.svg" width="16px"></span><strong>{dependencies[i+1].artifactId}</strong><hr><p if="{dependencies[i+1].description}">{dependencies[i+1].description}</p></div><br></div></div></virtual></div><div if="{notfound}" class="row center"><i>Sorry! Cannot find what you\'re looking for, please &nbsp;<a href="https://github.com/pmlopes/vertx-starter/issues/new">open an issue</a>&nbsp; so we know about the missing metadata!</i></div><div class="row" id="interaction"><div class="col-8"><button name="submit" type="submit">Generate</button> &nbsp; <a id="download-btn" onclick="{clean}" href="#" show="{downloading}" ref="download" download="{name}.zip" style="padding: 1.1rem 3.5rem; margin: 1rem 0; background: #782b90; color: #f5f5f5; border-radius: 2px; border: none; font-size: 1.3rem; transition: all .2s ease">Download</a></div><div class="col-4"><div if="{generating}" class="spinner"><div class="rect1"></div><div class="rect2"></div><div class="rect3"></div><div class="rect4"></div><div class="rect5"></div></div></div></div></form><div class="row"><div class="center"><span>powered with <span style="color:#f00000">&lt;3</span> by <a href="https://github.com/pmlopes/vertx-starter/tree/gh-pages">github.com</a></span></div></div></div>',"","",function(e){function i(i){var n=route.query(),d={dependencies:decodeURIComponent(n.dependencies||"").split(",")};if(i.languages){ga("send",{hitType:"event",eventCategory:i.id+":view",eventAction:i.id+"/view",eventLabel:"project"});var o=[];e.components.forEach(function(e,t){var n;return-1!==d.dependencies.indexOf(e.groupId+":"+e.artifactId+(e.classifier?":"+e.classifier:""))?(n=clone(e),n.checked=!0,n.id=t,void o.push(n)):-1!==d.dependencies.indexOf(e.groupId+":"+e.artifactId)?(n=clone(e),n.checked=!0,n.id=t,void o.push(n)):-1!==i.defaults.indexOf(e.groupId+":"+e.artifactId+(e.classifier?":"+e.classifier:""))?(n=clone(e),n.checked=!0,n.id=t,void o.push(n)):-1!==i.defaults.indexOf(e.groupId+":"+e.artifactId)?(n=clone(e),n.checked=!0,n.id=t,void o.push(n)):void 0});var s=t(i.id,i.languages[0].id),r={};s.forEach(function(e){r[e.group]||(r[e.group]=[]),r[e.group].push(e)}),a.update({downloading:!1,tool:i,presets:s,presetGroups:r,language:i.languages[0],dependencies:o})}else a.update({downloading:!1,tool:i,dependencies:[]})}function t(i,t){return e.presets.filter(function(e){if(e.languages){if(0===e.languages.filter(function(e){return e.id===t}).length)return!1;if(e.buildtool)return e.buildtool===i}else if(e.buildtool)return e.buildtool===i;return!0})}function n(e){var i=0;if(e.offsetParent){do{i+=e.offsetTop}while(e=e.offsetParent);return[i]}}var a=this,d=route.create();e.buildtools.forEach(function(e){d(e.id+"..",i.bind(a,e))}),d(i.bind(a,a.opts.buildtools[0])),this.changeLanguage=function(i){i.preventDefault();var n=a.language,d=a.tool.languages.filter(function(e){return e.id===i.target.value})[0];ga("send",{hitType:"event",eventCategory:d.id+":view",eventAction:d.id+"/view",eventLabel:"project"});var o=[].concat(a.dependencies);if(n)for(var s=0;s<o.length;s++){var r=o[s];"io.vertx"===r.groupId&&r.artifactId==="vertx-lang-"+n.id&&o.splice(s--,1)}e.components.forEach(function(e,i){if("io.vertx"===e.groupId&&e.artifactId==="vertx-lang-"+d.id&&0===o.filter(function(e){return e.id===i}).length){var t=clone(e);t.checked=!0,t.id=i,o.push(t)}});var l=t(a.tool.id,i.target.value),c={};l.forEach(function(e){c[e.group]||(c[e.group]=[]),c[e.group].push(e)}),a.update({downloading:!1,presets:l,presetGroups:c,preset:-1===l.indexOf(a.preset)?null:a.preset,language:d,dependencies:o})}.bind(this),this.changePreset=function(i){i.preventDefault();var t=a.preset,n={dependencies:["io.vertx:vertx-core"]};i.target.value&&(n=a.presets.filter(function(e){return e.id===i.target.value})[0],ga("send",{hitType:"event",eventCategory:n.id+":view",eventAction:n.id+"/view",eventLabel:"project"}));var d=[].concat(a.dependencies);if(t)for(var o=0;o<d.length;o++){var s=d[o];-1===t.dependencies.indexOf(s.groupId+":"+s.artifactId+(s.classifier?":"+s.classifier:""))?-1===t.dependencies.indexOf(s.groupId+":"+s.artifactId)||d.splice(o--,1):d.splice(o--,1)}e.components.forEach(function(e,i){var t;return-1!==n.dependencies.indexOf(e.groupId+":"+e.artifactId+(e.classifier?":"+e.classifier:""))&&0===d.filter(function(e){return e.id===i}).length?(t=clone(e),t.checked=!0,t.id=i,void d.push(t)):-1!==n.dependencies.indexOf(e.groupId+":"+e.artifactId)&&0===d.filter(function(e){return e.id===i}).length?(t=clone(e),t.checked=!0,t.id=i,void d.push(t)):void 0}),a.update({downloading:!1,preset:n,dependencies:d})}.bind(this),this.toggleDependency=function(e){a.dependencies[e.target.value].checked=!a.dependencies[e.target.value].checked,a.update({downloading:!1,dependencies:a.dependencies})}.bind(this),this.generate=function(i){i.preventDefault(),window.scroll(0,n(document.getElementById("interaction")));var t=i.target.submit,d=a.refs.download;t.disabled=!0,a.tool.fields.forEach(function(e){e.value=i.target[e.key].value}),a.preset&&a.preset.fields&&a.preset.fields.forEach(function(e){e.value=i.target[e.key].value});var o=a.dependencies.filter(function(e){return e.checked});compileProject({buildtool:a.tool,dependencies:o,language:a.language,preset:a.preset,components:e.components},function(e,i){if(e)return t.disabled=!1,a.update({generating:!1}),alert(e);JSZip.support.blob?i.generateAsync({type:"blob",platform:"UNIX"}).then(function(e){"#"!==d.href&&(window.webkitURL||window.URL).revokeObjectURL(d.href),d.href=(window.webkitURL||window.URL).createObjectURL(e),t.disabled=!1,a.update({generating:!1,downloading:!0});try{document.getElementById("download-btn").focus(),document.getElementById("download-btn").click()}catch(e){}},function(e){ga("send","exception",{exDescription:e.message,exFatal:!0}),alert(e)}):i.generateAsync({type:"base64",platform:"UNIX"}).then(function(e){t.disabled=!1,a.update({generating:!1,downloading:!0}),window.location="data:application/zip;base64,"+e},function(e){ga("send","exception",{exDescription:e.message,exFatal:!0}),alert(e)})}),a.update({generating:!0,downloading:!1,name:i.target.name.value})}.bind(this),this.clean=function(e){setTimeout(function(){a.downloading=!1,a.update()},500)}.bind(this),this.search=function(i){var t=[].concat(a.dependencies.filter(function(e){return e.checked})),n=i.target.value,d=0;n.length>0&&(e.components.forEach(function(e,i){if(-1!==e.artifactId.indexOf(n)||e.description&&-1!==e.description.indexOf(n)){var a=clone(e);a.checked=!1,a.id=i,t.push(a),d++}}),0===d&&ga("send",{hitType:"event",eventCategory:"search:fail",eventAction:n+"/fail",eventLabel:"component"})),a.update({notfound:n.length>0&&0===d,dependencies:t})}.bind(this)}),riot.tag2("navigation",'<li each="{opts.buildtools}" class="nav-item"><a href="#{id}" onclick="{closeMenu}">&nbsp;&nbsp;{id}</a></li>',"","",function(e){this.closeMenu=function(e){document.getElementById("nav-trigger").checked=!1}.bind(this)}),function(e){"use strict";function i(){}function t(e,i,t,n){var a,d,o,s=i.indexOf("."),r=i.lastIndexOf("/");e.metadata.packageName&&(e.metadata.dirName=e.metadata.packageName.replace(/\./g,"/")),e.metadata.fileName=i.substring(r+1,s),d=(d=i.replace("{package}",e.metadata.dirName||"")).substr(d.indexOf("/")+1),a=i.replace("{package}/",""),d=d.replace(/{(.*?)}/g,function(i,t){return e.metadata[t]||""}),a=a.replace(/{(.*?)}/g,function(e,i){return i}),(o=Handlebars.templates[a])?t?n.file(e.metadata.name.replace(/[ -]/g,"_")+"/"+d,o(e),{unixPermissions:"755"}):n.file(e.metadata.name.replace(/[ -]/g,"_")+"/"+d,o(e)):ga("send","exception",{exDescription:"Template not found: "+a,exFatal:!0})}e.clone=function(e){return i.prototype=e,new i},e.loadJSON=function(e,i){var t=new XMLHttpRequest;t.overrideMimeType("application/json"),t.open("GET",e,!0),t.onreadystatechange=function(){if(t.readyState===XMLHttpRequest.DONE){if(200!==t.status&&304!==t.status)return i("Failed to load: "+e+"!");i(null,t.responseText)}},t.send(null)},e.compileProject=function(e,i){var n,a=e.buildtool.executables||[];e.preset&&(a=a.concat(e.preset.executables||[])),ga("send",{hitType:"event",eventCategory:e.buildtool.id+":project",eventAction:e.buildtool.id+"/new",eventLabel:"project"}),e.dependenciesGAV={},e.dependencies.forEach(function(i){e.dependenciesGAV[i.groupId+":"+i.artifactId]=i.version,i.classifier&&(e.dependenciesGAV[i.groupId+":"+i.artifactId+":"+i.classifier]=i.version),ga("send",{hitType:"event",eventCategory:e.buildtool.id+":dependency",eventAction:e.buildtool.id+"/"+i.groupId+":"+i.artifactId+":"+i.version,eventLabel:"dependency"})}),e.bom=[],e.components.forEach(function(i){var t=clone(i);t.included=!1,e.bom.push(t)}),e.dependencies.forEach(function(i){e.bom[i.id].included=!0}),e.metadata={};var d=e.language.id;-1!==d.indexOf(" ")&&(d=d.substring(0,d.indexOf(" "))),e.metadata[d]=!0,e.metadata.artifactSuffix=e.buildtool["non-core-suffix"]||"",e.buildtool.fields.forEach(function(i){e.metadata[i.key]=i.value?i.value:i.prefill}),e.preset&&e.preset.fields&&e.preset.fields.forEach(function(i){e.metadata[i.key]=i.value?i.value:i.prefill}),e.metadata.groupId&&(e.metadata.packageName=e.metadata.groupId+"."+(e.metadata.artifactId||e.metadata.name.replace(/[ -]/g,"_"))),e.metadata.main=e.language.main.replace("{package}",e.metadata.packageName||"");var o=new JSZip,s=[];if(s=s.concat(e.buildtool.templates),e.language.templates&&(s=s.concat(e.language.templates)),e.preset&&(s=s.concat(e.preset.templates||[]),e.preset.languages)){var r=e.preset.languages.filter(function(i){return i.id===e.language.id});1===r.length&&(s=s.concat(r[0].templates||[]))}for(e.dependencies.forEach(function(e){s=s.concat(e.templates||[])}),n=0;n<s.length;n++)t(e,s[n],-1!==(a||[]).indexOf(s[n]),o);var l=e.buildtool.blob;e.preset&&(l=e.preset.blob||l),l?JSZipUtils.getBinaryContent(l,function(t,n){if(t)return ga("send","exception",{exDescription:t,exFatal:!0}),void i(t);o.loadAsync(n,{decodeFileName:function(i){return e.metadata.name.replace(/[ -]/g,"_")+"/"+String.fromCharCode.apply(null,i)}}).then(function(e){i(null,e)}).catch(function(e){ga("send","exception",{exDescription:e.message,exFatal:!0}),i(t)})}):i(null,o)}}(window);