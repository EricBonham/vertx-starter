riot.tag2("main",'<div if="{tool}" class="container"><div class="help-tip hide-phone"><p> The build tool can be changed using the hamburger menu on the left. For more information about this tool please visit <a href="{tool.url}">{tool.id}</a> website.<br><br> This is a progressive webapp, meaning that you can add it to your desktop and it can even run offline. You can boostrap your project even on the go without internet! </p></div><h1>{tool.id}: {tool.file}</h1><form onsubmit="{generate}"><div each="{f, i in tool.fields}" class="row"><virtual if="{i % 2 === 0}"><div class="col-6"><input name="{tool.fields[i].key}" type="{tool.fields[i].checkbox ? \'checkbox\' : \'text\'}" placeholder="{tool.fields[i].label + (tool.fields[i].prefill ? \' e.g.: \' + tool.fields[i].prefill : \'\')}" required="{tool.fields[i].required}"><label if="{tool.fields[i].checkbox}"><br><i>{tool.fields[i].label + (tool.fields[i].prefill ? \' e.g.: \' + tool.fields[i].prefill : \'\')}</i></label></div><div class="col-6"><input if="{tool.fields[i+1]}" name="{tool.fields[i+1].key}" type="{tool.fields[i+1].checkbox ? \'checkbox\' : \'text\'}" placeholder="{tool.fields[i+1].label + (tool.fields[i+1].prefill ? \' e.g.: \' + tool.fields[i+1].prefill : \'\')}" required="{tool.fields[i+1].required}"><label if="{tool.fields[i+1] && tool.fields[i+1].checkbox}"><br><i>{tool.fields[i+1].label + (tool.fields[i+1].prefill ? \' e.g.: \' + tool.fields[i+1].prefill : \'\')}</i></label></div></virtual></div><div if="{tool.languages || presets}" class="row"><div class="col-6"><select id="language" disabled="{!tool.languages || tool.languages.length == 0}" onchange="{changeLanguage}"><option each="{tool.languages}" riot-value="{id}">{id}</option></select></div><div class="col-6"><select id="preset" disabled="{!presetGroups || presetGroups.length == 0}" onchange="{changePreset}"><option value="">Empty Project</option><optgroup each="{g, i in presetGroups}" label="{i}"><option each="{g}" riot-value="{id}">{id}</option></optgroup></select></div></div><div if="{preset.fields}" class="row"><h5>Extra variables for {preset.id}:</h5></div><div each="{f, i in preset.fields}" class="row"><virtual if="{i % 2 === 0}"><div class="col-6"><input name="{preset.fields[i].key}" type="text" placeholder="{preset.fields[i].label + (preset.fields[i].prefill ? \' e.g.: \' + preset.fields[i].prefill : \'\')}" required="{preset.fields[i].required}"></div><div class="col-6"><input if="{preset.fields[i+1]}" name="{preset.fields[i+1].key}" type="text" placeholder="{preset.fields[i+1].label + (preset.fields[i+1].prefill ? \' e.g.: \' + preset.fields[i+1].prefill : \'\')}" required="{preset.fields[i+1].required}"></div></virtual></div><div class="row"><div class="col-6"><h1>Dependencies</h1></div><div class="col-6"><div id="not-found-tip" class="help-tip hide-phone"><p>Use this box to search for dependencies to add to your application, if a dependency is not present, please <a href="https://github.com/pmlopes/vertx-starter/issues/new">open an issue</a> so we can add the missing metadata!</p></div><input type="text" class="pull-right" placeholder="Search dependency..." onkeyup="{search}"></div></div><div each="{c, i in dependencies}" class="row"><virtual if="{i % 2 == 0}"><div class="col-6"><div class="{dependency: dependencies[i].checked}"><input name="dependencies" type="checkbox" riot-value="{i}" checked="{dependencies[i].checked}" onclick="{toggleDependency}"><div><span if="{dependencies[i].stack}" class="pull-right">&nbsp;<img src="img/stack.svg" width="16px"></span><span if="{dependencies[i].npm}" class="pull-right"><img src="img/npm.svg" width="16px"></span><strong>{dependencies[i].artifactId}</strong><hr><p if="{dependencies[i].deprecated}"><strong>DEPRECATED!!!</strong></p><p if="{dependencies[i].description}">{dependencies[i].description}</p></div><br></div></div><div class="col-6"><div if="{dependencies[i+1]}" class="{dependency: dependencies[i+1].checked}"><input name="dependencies" type="checkbox" riot-value="{i+1}" checked="{dependencies[i+1].checked}" onclick="{toggleDependency}"><div><span if="{dependencies[i+1].stack}" class="pull-right">&nbsp;<img src="img/stack.svg" width="16px"></span><span if="{dependencies[i+1].npm}" class="pull-right"><img src="img/npm.svg" width="16px"></span><strong>{dependencies[i+1].artifactId}</strong><hr><p if="{dependencies[i+1].deprecated}"><strong>DEPRECATED!!!</strong></p><p if="{dependencies[i+1].description}">{dependencies[i+1].description}</p></div><br></div></div></virtual></div><div if="{notfound}" class="row center"><i>Sorry! Cannot find what you\'re looking for, please &nbsp;<a href="https://github.com/pmlopes/vertx-starter/issues/new">open an issue</a>&nbsp; so we know about the missing metadata!</i></div><div class="row" id="interaction"><div class="col-8"><button name="submit" type="submit">Generate</button> &nbsp; <a id="download-btn" onclick="{clean}" href="#" show="{downloading}" ref="download" download="{name}.zip" style="padding: 1.1rem 3.5rem; margin: 1rem 0; background: #782b90; color: #f5f5f5; border-radius: 2px; border: none; font-size: 1.3rem; transition: all .2s ease">Download</a></div><div class="col-4"><div if="{generating}" class="spinner"><div class="rect1"></div><div class="rect2"></div><div class="rect3"></div><div class="rect4"></div><div class="rect5"></div></div></div></div></form><div class="row"><div class="center"><span>powered with <span style="color:#f00000">&lt;3</span> by <a href="https://github.com/pmlopes/vertx-starter/tree/gh-pages">github.com</a></span></div></div></div>',"","",function(l){var r=this,i=route.create();function t(n){var e=route.query(),a={dependencies:decodeURIComponent(e.dependencies||"").split(",")};if(n.languages){ga("send",{hitType:"event",eventCategory:n.id+":view",eventAction:n.id+"/view",eventLabel:"project"});var d=[];l.components.forEach(function(e,i){var t;return-1!==a.dependencies.indexOf(e.groupId+":"+e.artifactId+(e.classifier?":"+e.classifier:""))?((t=clone(e)).checked=!0,t.id=i,void d.push(t)):-1!==a.dependencies.indexOf(e.groupId+":"+e.artifactId)?((t=clone(e)).checked=!0,t.id=i,void d.push(t)):-1!==n.defaults.indexOf(e.groupId+":"+e.artifactId+(e.classifier?":"+e.classifier:""))?((t=clone(e)).checked=!0,t.id=i,void d.push(t)):-1!==n.defaults.indexOf(e.groupId+":"+e.artifactId)?((t=clone(e)).checked=!0,t.id=i,void d.push(t)):void 0});var i=c(n.id,n.languages[0].id),t={};i.forEach(function(e){t[e.group]||(t[e.group]=[]),t[e.group].push(e)}),r.update({downloading:!1,tool:n,presets:i,presetGroups:t,language:n.languages[0],dependencies:d})}else r.update({downloading:!1,tool:n,dependencies:[]})}function c(i,t){return l.presets.filter(function(e){if(e.languages){if(0===e.languages.filter(function(e){return e.id===t}).length)return!1;if(e.buildtool)return e.buildtool===i}else if(e.buildtool)return e.buildtool===i;return!0})}l.buildtools.forEach(function(e){i(e.id+"..",t.bind(r,e))}),i(t.bind(r,r.opts.buildtools[0])),this.changeLanguage=function(i){i.preventDefault();var e=r.language,n=r.tool.languages.filter(function(e){return e.id===i.target.value})[0];ga("send",{hitType:"event",eventCategory:n.id+":view",eventAction:n.id+"/view",eventLabel:"project"});var a=[].concat(r.dependencies);if(e&&!e.noLangSupport)for(var t=0;t<a.length;t++){var d=a[t];"io.vertx"===d.groupId&&d.artifactId==="vertx-lang-"+e.id&&a.splice(t--,1)}n&&!n.noLangSupport&&l.components.forEach(function(e,i){if("io.vertx"===e.groupId&&e.artifactId==="vertx-lang-"+n.id&&0===a.filter(function(e){return e.id===i}).length){var t=clone(e);t.checked=!0,t.id=i,a.push(t)}});var o=c(r.tool.id,i.target.value),s={};o.forEach(function(e){s[e.group]||(s[e.group]=[]),s[e.group].push(e)}),r.update({downloading:!1,presets:o,presetGroups:s,preset:-1===o.indexOf(r.preset)?null:r.preset,language:n,dependencies:a})}.bind(this),this.changePreset=function(i){i.preventDefault();var e=r.preset,n={dependencies:["io.vertx:vertx-core"]};i.target.value&&(n=r.presets.filter(function(e){return e.id===i.target.value})[0],ga("send",{hitType:"event",eventCategory:n.id+":view",eventAction:n.id+"/view",eventLabel:"project"}));var a=[].concat(r.dependencies);if(e)for(var t=0;t<a.length;t++){var d=a[t];-1===e.dependencies.indexOf(d.groupId+":"+d.artifactId+(d.classifier?":"+d.classifier:""))?-1===e.dependencies.indexOf(d.groupId+":"+d.artifactId)||a.splice(t--,1):a.splice(t--,1)}l.components.forEach(function(e,i){var t;return-1!==n.dependencies.indexOf(e.groupId+":"+e.artifactId+(e.classifier?":"+e.classifier:""))&&0===a.filter(function(e){return e.id===i}).length?((t=clone(e)).checked=!0,t.id=i,void a.push(t)):-1!==n.dependencies.indexOf(e.groupId+":"+e.artifactId)&&0===a.filter(function(e){return e.id===i}).length?((t=clone(e)).checked=!0,t.id=i,void a.push(t)):void 0}),r.update({downloading:!1,preset:n,dependencies:a})}.bind(this),this.toggleDependency=function(e){r.dependencies[e.target.value].checked=!r.dependencies[e.target.value].checked,r.update({downloading:!1,dependencies:r.dependencies})}.bind(this),this.generate=function(i){i.preventDefault(),window.scroll(0,function(e){var i=0;if(e.offsetParent){for(;i+=e.offsetTop,e=e.offsetParent;);return[i]}}(document.getElementById("interaction")));var t=i.target.submit,n=r.refs.download;t.disabled=!0,r.tool.fields.forEach(function(e){e.value=i.target[e.key].value}),r.preset&&r.preset.fields&&r.preset.fields.forEach(function(e){e.value=i.target[e.key].value});var e=r.dependencies.filter(function(e){return e.checked});compileProject({buildtool:r.tool,dependencies:e,language:r.language,preset:r.preset,components:l.components},function(e,i){if(e)return t.disabled=!1,r.update({generating:!1}),alert(e);JSZip.support.blob?i.generateAsync({type:"blob",platform:"UNIX"}).then(function(e){"#"!==n.href&&(window.webkitURL||window.URL).revokeObjectURL(n.href),n.href=(window.webkitURL||window.URL).createObjectURL(e),t.disabled=!1,r.update({generating:!1,downloading:!0});try{document.getElementById("download-btn").focus(),document.getElementById("download-btn").click()}catch(e){}},function(e){ga("send","exception",{exDescription:e.message,exFatal:!0}),alert(e)}):i.generateAsync({type:"base64",platform:"UNIX"}).then(function(e){t.disabled=!1,r.update({generating:!1,downloading:!0}),window.location="data:application/zip;base64,"+e},function(e){ga("send","exception",{exDescription:e.message,exFatal:!0}),alert(e)})}),r.update({generating:!0,downloading:!1,name:i.target.name.value})}.bind(this),this.clean=function(e){setTimeout(function(){r.downloading=!1,r.update()},500)}.bind(this),this.search=function(e){var n=[].concat(r.dependencies.filter(function(e){return e.checked})),a=e.target.value,d=0;0<a.length&&(l.components.forEach(function(e,i){if(-1!==e.artifactId.indexOf(a)||e.description&&-1!==e.description.indexOf(a)){var t=clone(e);t.checked=!1,t.id=i,n.push(t),d++}}),0===d&&ga("send",{hitType:"event",eventCategory:"search:fail",eventAction:a+"/fail",eventLabel:"component"})),r.update({notfound:0<a.length&&0===d,dependencies:n})}.bind(this)}),riot.tag2("navigation",'<li each="{opts.buildtools}" class="nav-item"><a href="#{id}" onclick="{closeMenu}">&nbsp;&nbsp;{id}</a></li>',"","",function(e){this.closeMenu=function(e){document.getElementById("nav-trigger").checked=!1}.bind(this)}),function(e){"use strict";function i(){}e.clone=function(e){return i.prototype=e,new i},e.loadJSON=function(e,i){var t=new XMLHttpRequest;t.overrideMimeType("application/json"),t.open("GET",e,!0),t.onreadystatechange=function(){if(t.readyState===XMLHttpRequest.DONE){if(200!==t.status&&304!==t.status)return i("Failed to load: "+e+"!");i(null,t.responseText)}},t.send(null)}}(window),function(e){"use strict";function r(t,e,i,n){var a,d,o,s=e.indexOf("."),l=e.lastIndexOf("/");t.metadata.packageName&&(t.metadata.dirName=t.metadata.packageName.replace(/\./g,"/")),t.metadata.fileName=e.substring(l+1,s),d=(d=e.replace("{package}",t.metadata.dirName||"")).substr(d.indexOf("/")+1),a=e.replace("{package}/",""),d=d.replace(/{(.*?)}/g,function(e,i){return t.metadata[i]||""}),a=a.replace(/{(.*?)}/g,function(e,i){return i}),(o=Handlebars.templates[a])?i?n.file(t.metadata.name.replace(/[ -]/g,"_")+"/"+d,o(t),{unixPermissions:"755"}):n.file(t.metadata.name.replace(/[ -]/g,"_")+"/"+d,o(t)):ga("send","exception",{exDescription:"Template not found: "+a,exFatal:!0})}window.compileProject=function(t,n){var e,i=t.buildtool.executables||[];t.preset&&(i=i.concat(t.preset.executables||[])),ga("send",{hitType:"event",eventCategory:t.buildtool.id+":project",eventAction:t.buildtool.id+"/new",eventLabel:"project"}),t.dependenciesGAV={},t.npmDevDependencies=[],t.npmProdDependencies=[],t.npmMavenDependencies=[],t.dependencies.forEach(function(e){t.dependenciesGAV[e.groupId+":"+e.artifactId]=e.version,e.classifier&&(t.dependenciesGAV[e.groupId+":"+e.artifactId+":"+e.classifier]=e.version),e.npm?"test"===e.scope?t.npmDevDependencies.push(e):t.npmProdDependencies.push(e):t.npmMavenDependencies.push(e),ga("send",{hitType:"event",eventCategory:t.buildtool.id+":dependency",eventAction:t.buildtool.id+"/"+e.groupId+":"+e.artifactId+":"+e.version,eventLabel:"dependency"})}),t.bom=[],t.components.forEach(function(e){var i=clone(e);i.included=!1,t.bom.push(i)}),t.dependencies.forEach(function(e){t.bom[e.id].included=!0}),t.metadata={};var a=t.language.id;-1!==a.indexOf(" ")&&(a=a.substring(0,a.indexOf(" "))),t.metadata[a]=!0,t.metadata.artifactSuffix=t.buildtool["non-core-suffix"]||"";var d=[];t.buildtool.fields.forEach(function(e){e.checkbox?(t.metadata[e.key]="on"===e.value,Array.isArray(t.buildtool[e.key+"Templates"])&&(d=d.concat(t.buildtool[e.key+"Templates"])),ga("send",{hitType:"event",eventCategory:t.buildtool.id+":feature",eventAction:t.buildtool.id+"/"+e.key,eventLabel:"feature"})):t.metadata[e.key]=e.value?e.value:e.prefill}),t.preset&&t.preset.fields&&t.preset.fields.forEach(function(e){t.metadata[e.key]=e.value?e.value:e.prefill}),t.metadata.groupId&&(t.metadata.packageName=t.metadata.groupId+"."+(t.metadata.artifactId||t.metadata.name.replace(/[ -]/g,"_"))),t.metadata.main=t.language.main.replace("{package}",t.metadata.packageName||"");var o=new JSZip;if(d=d.concat(t.buildtool.templates),t.language.templates&&(d=d.concat(t.language.templates)),t.preset&&(d=d.concat(t.preset.templates||[]),t.preset.languages)){var s=t.preset.languages.filter(function(e){return e.id===t.language.id});1===s.length&&(d=d.concat(s[0].templates||[]))}for(t.dependencies.forEach(function(e){d=(d=d.concat(e.templates||[])).concat(e[t.language.id+"Templates"]||[])}),e=0;e<d.length;e++)r(t,d[e],-1!==(i||[]).indexOf(d[e]),o);var l=t.buildtool.blob;t.preset&&(l=t.preset.blob||l),l?JSZipUtils.getBinaryContent(l,function(i,e){if(i)return ga("send","exception",{exDescription:i,exFatal:!0}),void n(i);o.loadAsync(e,{decodeFileName:function(e){return t.metadata.name.replace(/[ -]/g,"_")+"/"+String.fromCharCode.apply(null,e)}}).then(function(e){n(null,e)}).catch(function(e){ga("send","exception",{exDescription:e.message,exFatal:!0}),n(i)})}):n(null,o)}}();